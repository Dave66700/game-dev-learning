## 核心游戏循环

现在我们要做的东西：

**敌人不断生成 → 玩家战斗 → 击杀 → 再生成 → 难度提升**

## Step 1 创建空物体

Create Empty

命名：EnemySpawner

## Step 2 新建脚本EnemySpawner.cs

```
using UnityEngine;

public class EnemySpawner : MonoBehaviour
{
    public GameObject enemyPrefab;
    public float spawnRadius = 15f;
    public float spawnInterval = 3f;
    public int maxEnemies = 5;

    private float timer;
    private int currentEnemies = 0;

    void Update()
    {
        timer += Time.deltaTime;

        if (timer >= spawnInterval && currentEnemies < maxEnemies)
        {
            SpawnEnemy();
            timer = 0f;
        }
    }

    void SpawnEnemy()
    {
        Vector3 randomPos = transform.position + Random.insideUnitSphere * spawnRadius;
        randomPos.y = 1f;

        Instantiate(enemyPrefab, randomPos, Quaternion.identity);
        currentEnemies++;
    }

    public void EnemyDied()
    {
        currentEnemies--;
    }
}

```


第一部分

定义变量部分

```
public GameObject enemyPrefab;    // 要生成的敌人预制体
public float spawnRadius = 15f;   // 生成半径（以生成器为中心）
public float spawnInterval = 3f;  // 生成间隔时间（秒）
public int maxEnemies = 5;        // 最大敌人数

private float timer;              // 计时器（记录经过的时间）
private int currentEnemies = 0;   // 当前敌人数
```

第二部分

update方法 - 核心逻辑

```
void Update()
{
    timer += Time.deltaTime;  // 每帧增加时间

    // 条件判断：时间到了 + 敌人没到上限
    if (timer >= spawnInterval && currentEnemies < maxEnemies)
    {
        SpawnEnemy();  // 生成敌人
        timer = 0f;    // 重置计时器
    }
}
```
timer:利用time.deltatime制作一个计时器，用于后面if语句的判断

if语句，时间间隔是前面定义出来的，如果大于时间间隔，并且呢当前的人数不足，就生成敌人+重置计时器


第三部分：SpawnEnemy() 方法 - 生成敌人

```
void SpawnEnemy()
{
    // 1. 计算随机位置
    Vector3 randomPos = transform.position + Random.insideUnitSphere * spawnRadius;
    randomPos.y = 1f;  // 固定Y轴高度（防止敌人陷地或悬空）

    // 2. 实例化敌人
    Instantiate(enemyPrefab, randomPos, Quaternion.identity);
    
    // 3. 敌人计数+1
    currentEnemies++;
}
```

位置计算：


首先随机位置是三维向量；因此是Vector3，然后取生成器的位置，也就是Transform.position.
根据单位球的世界坐标，找一个随机的点也就是 Random.insideUnitSphere，与此同时扩展到指定的半径
*spawnRadius

由于不希望敌人卡在地里面，或者出现在不对的位置，因此要：强制Y=1，确保敌人站在地面上

代码 randomPos.y = 1f:

### Instantiate 详解

Instantiate(enemyPrefab, randomPos, Quaternion.identity); 详解
这是 Unity 中最核心的函数之一，用于动态创建游戏对象。

三个参数
1. enemyPrefab - 要实例化的预制体

2. randomPos - 生成位置

3. Quaternion.identity - 旋转（无旋转）



第四部分：EnemyDied() 方法 - 敌人死亡回调

```
public void EnemyDied()
{
    currentEnemies--;  // 敌人死亡，计数-1
}
```







